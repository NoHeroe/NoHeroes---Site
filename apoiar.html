<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Apoiar — NoHeroes</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<!-- PayPal SDK (trocar client-id) -->
<script src="https://www.paypal.com/sdk/js?client-id=SEU_CLIENT_ID&currency=BRL" data-sdk-integration-source="button-factory"></script>
<!-- QRCode lib para PIX -->
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
<style>
  :root{
    --nh-bg:#0a0a0a; --nh-fg:#e5e5e5; --nh-muted:#bdbdbd;
    --grad: linear-gradient(135deg,#8f4fff 0%,#facc15 100%);
    --border: rgba(255,255,255,.1);
    --glass: rgba(255,255,255,.04);
    --radius:16px;
    --reveal-duration: 1000ms;
  }
  body{font-family:Inter,system-ui,Arial,sans-serif; background:var(--nh-bg); color:var(--nh-fg); overflow-x:hidden}
  h1,h2,h3,.cinzel{font-family:"Cinzel Decorative",serif}
  .grad-text{background:var(--grad); -webkit-background-clip:text; background-clip:text; color:transparent}
  .card{background:var(--glass); border:1px solid var(--border); border-radius:var(--radius); backdrop-filter: blur(10px)}
  .btn{display:inline-flex; align-items:center; justify-content:center; gap:.6rem; padding:.9rem 1.2rem; border-radius:999px; border:1px solid var(--border); background:rgba(255,255,255,.05); transition:.25s; font-weight:600}
  .btn:hover{transform:translateY(-1px); background:rgba(255,255,255,.08)}
  .btn-primary{background:var(--grad); color:#000; border:none}
  .btn-primary:hover{filter:saturate(1.05); transform:translateY(-1px) scale(1.01)}
  .btn-ghost{background:rgba(255,255,255,.04)}
  .kpi{display:flex; gap:.75rem; align-items:center}
  .kpi .dot{width:.6rem; height:.6rem; border-radius:999px; background:linear-gradient(135deg,#8f4fff,#facc15)}
  .progress{height:.6rem; border-radius:999px; background:#1a1a1a; border:1px solid var(--border); overflow:hidden}
  .progress > span{display:block; height:100%; background:var(--grad)}

  /* Cinematic reveal */
  .reveal{opacity:0; transform: translateY(18px) scale(.985); filter:blur(6px); will-change:opacity,transform,filter}
  .reveal.in{animation:cinematic var(--reveal-duration) cubic-bezier(.22,.61,.36,1) var(--reveal-delay,0ms) both}
  @keyframes cinematic{
    0%{opacity:0; transform:translateY(18px) scale(.985); filter:blur(6px)}
    60%{opacity:1; transform:translateY(0) scale(1); filter:blur(.8px)}
    100%{opacity:1; transform:translateY(0) scale(1); filter:blur(0)}
  }
  @media (prefers-reduced-motion: reduce){ .reveal{opacity:1; transform:none; filter:none} .reveal.in{animation:none} }

  /* Overlay/modal */
  .overlay{position:fixed; inset:0; background:rgba(0,0,0,.7); display:none; align-items:center; justify-content:center; z-index:60}
  .overlay.show{display:flex}
  .modal{background:#151515; border:1px solid var(--border); border-radius:18px; width:min(640px,92vw); padding:1.2rem}
  .field{display:grid; gap:.4rem}
  .input{background:#0e0e0e; border:1px solid var(--border); border-radius:10px; padding:.7rem .8rem; color:var(--nh-fg)}

  /* Header refinado (visual original) */
  .topbar{position:fixed; top:0; left:0; right:0; height:66px; background:rgba(10,10,10,.85); border-bottom:1px solid #262626; backdrop-filter: blur(10px); z-index:50}
  .logo-wrap{position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); z-index:30}
  .logo-wrap img{height:52px; filter: drop-shadow(0 2px 8px rgba(250,204,21,.15))}
  .bar-grad{position:fixed; top:66px; left:0; right:0; height:4px; background:linear-gradient(90deg,#8f4fff,#facc15); box-shadow:0 0 6px #8f4fff88,0 0 10px #facc1588; z-index:40}
  .hamb{position:absolute; right:14px; top:50%; transform:translateY(-50%); width:40px; height:40px; border-radius:10px; display:grid; place-items:center; border:1px solid #2b2b2b; background:#0f0f0f}
  .hamb span{display:block; width:20px; height:2px; background:#eaeaea; position:relative}
  .hamb span::before,.hamb span::after{content:""; position:absolute; left:0; width:20px; height:2px; background:#eaeaea}
  .hamb span::before{top:-6px} .hamb span::after{top:6px}

  /* Drawer */
  #drawer{position:fixed; top:0; right:0; width:18rem; height:100%; background:#000; color:#fff; transform:translateX(100%); transition:transform .3s; z-index:55; border-left:1px solid #212121}
  #drawer.show{transform:translateX(0)}
  #drawerOverlay{position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; z-index:54}
  #drawerOverlay.show{display:block}

  /* Canvas brasas */
  #brasasCanvas{position:fixed; inset:0; width:100vw; height:100vh; z-index:-1; pointer-events:none}

  /* Mobile safe */
  html,body,main{max-width:100vw; overflow-x:hidden}
</style>
</head>
<body>
  <!-- BACKGROUND (brasas) -->
  <canvas id="brasasCanvas" aria-hidden="true"></canvas>

  <!-- HEADER -->
  <header class="topbar">
    <button id="hamburgerBtn" class="hamb" aria-label="Abrir menu"><span></span></button>
    <div class="logo-wrap">
      <a href="index.html" aria-label="NoHeroes">
        <img src="assets/images/noheroes logo.png" alt="NoHeroes" />
      </a>
    </div>
  </header>
  <div class="bar-grad" aria-hidden="true"></div>

  <!-- DRAWER -->
  <aside id="drawer" role="dialog" aria-modal="true" aria-label="Menu">
    <button id="drawerClose" class="absolute top-3 right-4 text-2xl">✕</button>
    <nav class="p-6 grid gap-2 text-sm mt-10">
      <a href="index.html" class="py-2 px-3 rounded hover:bg-[#151515]">Início</a>
      <a href="projects.html" class="py-2 px-3 rounded hover:bg-[#151515]">Projetos</a>
      <a href="sobre.html" class="py-2 px-3 rounded hover:bg-[#151515]">Sobre</a>
      <a href="shop.html" class="py-2 px-3 rounded hover:bg-[#151515]">Loja</a>
      <a href="oraculum.html" class="py-2 px-3 rounded hover:bg-[#151515]">Oráculo</a>
    </nav>
  </aside>
  <div id="drawerOverlay" aria-hidden="true"></div>

  <!-- CONTEÚDO -->
  <main class="max-w-3xl mx-auto px-4 pt-44 pb-24 relative z-10">
    <h1 class="cinzel text-3xl sm:text-4xl grad-text reveal">Apoie o Universo NoHeroes</h1>
    <p class="mt-3 text-white/70 leading-relaxed reveal" style="--reveal-delay:90ms">
      Cada contribuição mantém o coração do universo batendo e acelera novas criações. Simples, transparente e digno da sua confiança.
    </p>

    <!-- Metas compactas -->
    <section class="mt-8 grid gap-4 sm:grid-cols-2">
      <article class="card p-4 reveal">
        <div class="kpi">
          <span class="dot" aria-hidden="true"></span>
          <h2 class="cinzel text-lg">Meta Geral — NoHeroes</h2>
        </div>
        <div class="mt-3 flex items-end justify-between">
          <div>
            <div class="text-sm text-white/60">Arrecadado</div>
            <div class="text-xl font-semibold"><span id="mGeralValor">R$ 0,00</span></div>
          </div>
          <div class="text-right">
            <div class="text-sm text-white/60">Meta</div>
            <div class="text-xl font-semibold" id="mGeralMeta">R$ 500.000,00</div>
          </div>
        </div>
        <div class="mt-3 progress"><span id="mGeralBar" style="width:0%"></span></div>
        <div class="mt-1 text-xs text-white/50"><span id="mGeralPerc">0%</span> concluído</div>
      </article>

      <article class="card p-4 reveal" style="--reveal-delay:120ms">
        <div class="kpi">
          <span class="dot" aria-hidden="true"></span>
          <h2 class="cinzel text-lg">Meta — Servidor do Universo</h2>
        </div>
        <div class="mt-3 flex items-end justify-between">
          <div>
            <div class="text-sm text-white/60">Arrecadado</div>
            <div class="text-xl font-semibold"><span id="mServValor">R$ 0,00</span></div>
          </div>
          <div class="text-right">
            <div class="text-sm text-white/60">Meta</div>
            <div class="text-xl font-semibold" id="mServMeta">R$ 12.000,00</div>
          </div>
        </div>
        <div class="mt-3 progress"><span id="mServBar" style="width:0%"></span></div>
        <div class="mt-1 text-xs text-white/50"><span id="mServPerc">0%</span> concluído</div>
      </article>
    </section>

    <!-- Ações -->
    <section class="mt-10 grid gap-3 sm:grid-cols-2 reveal" style="--reveal-delay:140ms">
      <button id="btnContribuir" class="btn btn-primary w-full">Contribuir / Doar</button>
      <button id="btnSolicitar" class="btn btn-ghost w-full">Pedir serviço / ajuda</button>
    </section>

    <!-- Leads -->
    <section class="mt-10 card p-4 reveal" style="--reveal-delay:160ms">
      <h3 class="cinzel text-lg">Receba novidades e metas</h3>
      <form id="formLead" class="mt-3 grid gap-3 sm:grid-cols-2" autocomplete="on">
        <input class="input" name="nome" placeholder="Seu nome" required />
        <input class="input" type="email" name="email" placeholder="Seu e-mail" required />
        <button class="btn btn-primary sm:col-span-2" type="submit">Assinar</button>
      </form>
      <p class="mt-2 text-xs text-white/50">Os valores exibidos são estáticos no front até conectar webhooks.</p>
    </section>
  </main>

  <!-- MODAL: Contribuir -->
  <div id="modalContribuir" class="overlay" role="dialog" aria-modal="true" aria-label="Contribuir">
    <div class="modal">
      <h3 class="cinzel text-xl grad-text">Contribuir</h3>
      <form id="formDoacao" class="mt-3 grid gap-3">
        <div class="field">
          <label class="text-sm text-white/70">Valor (R$)</label>
          <input class="input" type="number" min="1" step="0.01" name="valor" placeholder="Ex.: 25.00" required />
        </div>
        <div class="field">
          <label class="text-sm text-white/70">Destino</label>
          <select class="input" name="destino">
            <option value="geral">Meta Geral — NoHeroes</option>
            <option value="servidor">Servidor do Universo</option>
          </select>
        </div>
        <div class="grid gap-2 sm:grid-cols-3">
          <button class="btn btn-primary" type="button" id="payPix">PIX</button>
          <button class="btn btn-ghost" type="button" id="payMP">Mercado Pago</button>
          <button class="btn btn-ghost" type="button" id="payPayPal">PayPal</button>
        </div>
      </form>
      <div class="mt-3 flex justify-end gap-2">
        <button class="btn" data-close>Fechar</button>
      </div>
    </div>
  </div>

  <!-- MODAL: PIX (QR + copia e cola) -->
  <div id="modalPix" class="overlay" role="dialog" aria-modal="true" aria-label="PIX">
    <div class="modal">
      <h3 class="cinzel text-xl grad-text">PIX</h3>
      <p class="text-white/70 text-sm">Escaneie o QR ou copie o código “copia e cola”.</p>
      <div class="mt-3 grid gap-3 place-items-center">
        <div id="pixQr"></div>
        <div class="w-full grid gap-2">
          <textarea id="pixCode" class="input" rows="3" readonly></textarea>
          <button class="btn btn-primary" id="copyPix">Copiar código PIX</button>
        </div>
      </div>
      <div class="mt-3 flex justify-end gap-2">
        <button class="btn" data-close>Fechar</button>
      </div>
    </div>
  </div>

  <!-- MODAL: Mercado Pago -->
  <div id="modalMP" class="overlay" role="dialog" aria-modal="true" aria-label="Mercado Pago">
    <div class="modal">
      <h3 class="cinzel text-xl grad-text">Mercado Pago</h3>
      <p class="text-white/70 text-sm">Abriremos o checkout em outra aba.</p>
      <div class="mt-3">
        <a id="mpLink" class="btn btn-primary w-full" target="_blank" rel="noopener"
           href="https://www.mercadopago.com.br/checkout/v1/redirect?pref_id=SUA_PREFERENCE_ID">Ir para o checkout</a>
      </div>
      <div class="mt-3 flex justify-end gap-2">
        <button class="btn" data-close>Fechar</button>
      </div>
    </div>
  </div>

  <!-- MODAL: PayPal -->
  <div id="modalPayPal" class="overlay" role="dialog" aria-modal="true" aria-label="PayPal">
    <div class="modal">
      <h3 class="cinzel text-xl grad-text">PayPal</h3>
      <p class="text-white/70 text-sm">Pague com PayPal ou cartão (processado pelo PayPal).</p>
      <div class="mt-3"><div id="paypalButtons"></div></div>
      <div class="mt-3 flex justify-end gap-2">
        <button class="btn" data-close>Fechar</button>
      </div>
    </div>
  </div>

  <!-- MODAL: Solicitar serviço/ajuda -->
  <div id="modalSolicitar" class="overlay" role="dialog" aria-modal="true" aria-label="Solicitar serviço/ajuda">
    <div class="modal">
      <h3 class="cinzel text-xl grad-text">Pedir serviço / ajuda</h3>
      <form id="formSolicitar" class="mt-3 grid gap-3">
        <input class="input" name="nome" placeholder="Seu nome" required />
        <input class="input" type="email" name="email" placeholder="Seu e-mail" required />
        <button class="btn btn-primary" type="submit">Enviar</button>
      </form>
      <div class="mt-3 flex justify-end">
        <button class="btn" data-close>Fechar</button>
      </div>
    </div>
  </div>

  <footer class="py-10 text-center text-white/50 text-sm">
    © <span id="year"></span> NoHeroes. Todos os direitos reservados.
  </footer>

<script>
/* ===== Drawer ===== */
const drawer = document.getElementById('drawer');
const drawerOv = document.getElementById('drawerOverlay');
const btnHam = document.getElementById('hamburgerBtn');
const btnClose = document.getElementById('drawerClose');
const toggleDrawer = (open) => {
  drawer.classList.toggle('show', open);
  drawerOv.classList.toggle('show', open);
  if(open){
    document.addEventListener('keydown', escDrawer);
    setTimeout(()=>document.addEventListener('click', outsideDrawer, {capture:true}),0);
  }else{
    document.removeEventListener('keydown', escDrawer);
    document.removeEventListener('click', outsideDrawer, {capture:true});
  }
};
const escDrawer = (e)=>{ if(e.key==='Escape') toggleDrawer(false); };
const outsideDrawer = (e)=>{ if(!drawer.contains(e.target) && e.target!==btnHam) toggleDrawer(false); };
btnHam.addEventListener('click', ()=>toggleDrawer(true));
btnClose.addEventListener('click', ()=>toggleDrawer(false));
drawerOv.addEventListener('click', ()=>toggleDrawer(false));

/* ===== Reveal ===== */
const sections = document.querySelectorAll('main, header, footer');
sections.forEach(section=>{
  const items = Array.from(section.querySelectorAll('.reveal'));
  if(!items.length) return;
  const io = new IntersectionObserver((entries,obs)=>{
    entries.forEach(e=>{
      if(!e.isIntersecting) return;
      items.forEach((el,i)=>{ el.style.setProperty('--reveal-delay', `${i*70}ms`); el.classList.add('in'); });
      obs.unobserve(e.target);
    });
  },{threshold:.14, rootMargin:'0px 0px -8% 0px'});
  io.observe(section);
});

/* ===== Brasas canvas ===== */
const canvas = document.getElementById('brasasCanvas'), ctx = canvas.getContext('2d');
const fit=()=>{ canvas.width=innerWidth; canvas.height=innerHeight; }; addEventListener('resize',fit); fit();
let parts=[];
const seed=()=>{ parts=Array.from({length:90},()=>({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:1+Math.random()*1.2,v:-.2-Math.random()*.5,a:.4+.4*Math.random()})); };
const tick=()=>{ ctx.clearRect(0,0,canvas.width,canvas.height);
  for(const p of parts){ p.y+=p.v; if(p.y<0) p.y=canvas.height;
    ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,2*Math.PI);
    ctx.fillStyle=`rgba(168,85,247,${p.a})`; ctx.shadowColor="#a855f7"; ctx.shadowBlur=10; ctx.fill(); }
  requestAnimationFrame(tick);
};
seed(); tick();

/* ===== Metas (estático no front até webhooks) ===== */
const fmtBRL = (v)=> v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
const metas = {geral: 500000, servidor: 12000};
const totals = {geral: 0, servidor: 0}; // TODO: substituir por GET /api/goals quando tiver backend
function renderMetas(){
  document.getElementById('mGeralValor').textContent = fmtBRL(totals.geral);
  document.getElementById('mGeralMeta').textContent  = fmtBRL(metas.geral);
  const p1 = Math.min(100, Math.round((totals.geral/metas.geral)*100))||0;
  document.getElementById('mGeralBar').style.width = p1+'%';
  document.getElementById('mGeralPerc').textContent = p1+'%';

  document.getElementById('mServValor').textContent = fmtBRL(totals.servidor);
  document.getElementById('mServMeta').textContent  = fmtBRL(metas.servidor);
  const p2 = Math.min(100, Math.round((totals.servidor/metas.servidor)*100))||0;
  document.getElementById('mServBar').style.width = p2+'%';
  document.getElementById('mServPerc').textContent = p2+'%';
}
renderMetas();

/* ===== Modais ===== */
const overlays = document.querySelectorAll('.overlay');
document.querySelectorAll('.overlay [data-close]').forEach(b=> b.addEventListener('click', e=> e.currentTarget.closest('.overlay').classList.remove('show')));
overlays.forEach(ov=> ov.addEventListener('click', (e)=>{ if(e.target===ov) ov.classList.remove('show'); }));
addEventListener('keydown', (e)=>{ if(e.key==='Escape') overlays.forEach(ov=> ov.classList.remove('show')); });

/* ===== Botões principais ===== */
document.getElementById('btnContribuir').addEventListener('click', ()=> document.getElementById('modalContribuir').classList.add('show'));
document.getElementById('btnSolicitar').addEventListener('click', ()=> document.getElementById('modalSolicitar').classList.add('show'));

/* ===== Doação: estado atual do formulário ===== */
let pendingDonation = {valor:0, destino:'geral'};
document.getElementById('formDoacao').addEventListener('input', (e)=>{
  const f = new FormData(e.currentTarget);
  pendingDonation.valor   = Number(f.get('valor')||0);
  pendingDonation.destino = f.get('destino')||'geral';
});

// ----- PIX: payload BR Code + QR -----
function emv(k, v){ const len = String(v.length).padStart(2,'0'); return `${k}${len}${v}`; }
function crc16(payload){
  let p = 0x1021, crc = 0xFFFF;
  for (let i=0;i<payload.length;i++){
    crc ^= (payload.charCodeAt(i) << 8);
    for(let j=0;j<8;j++){ crc = (crc & 0x8000) ? (crc << 1) ^ p : (crc << 1); crc &= 0xFFFF; }
  }
  return crc.toString(16).toUpperCase().padStart(4,'0');
}
function buildPix({key, name, city, txid='NOHEROES', amount, desc=''}) {
  const ID_PAYLOAD_FORMAT='00', ID_MERCHANT_ACCOUNT='26', ID_MERCHANT_CAT='52', ID_TRANSACTION_CURRENCY='53',
        ID_TRANSACTION_AMOUNT='54', ID_COUNTRY_CODE='58', ID_MERCHANT_NAME='59', ID_MERCHANT_CITY='60',
        ID_ADDITIONAL_DATA='62', ID_CRC='63';
  const gui = emv('00','br.gov.bcb.pix');
  const k = emv('01', key);
  const d = desc ? emv('02', desc.substring(0,25)) : '';
  const mai = emv(ID_MERCHANT_ACCOUNT, gui + k + d);
  const add = emv(ID_ADDITIONAL_DATA, emv('05', txid.substring(0,25)));
  let payload =
    emv(ID_PAYLOAD_FORMAT,'01') + mai +
    emv(ID_MERCHANT_CAT,'0000') + emv(ID_TRANSACTION_CURRENCY,'986') +
    (amount ? emv(ID_TRANSACTION_AMOUNT, String(amount.toFixed(2))) : '') +
    emv(ID_COUNTRY_CODE,'BR') + emv(ID_MERCHANT_NAME, name.substring(0,25)) +
    emv(ID_MERCHANT_CITY, city.substring(0,15)) + add;
  payload += ID_CRC + '04';
  const crc = crc16(payload + '0000');
  return payload + crc;
}

const pixModal = document.getElementById('modalPix');
const payPixBtn = document.getElementById('payPix');
payPixBtn.setAttribute('type','button'); // garante que não faz submit
payPixBtn.addEventListener('click', ()=>{
  if(!pendingDonation.valor){ alert('Informe um valor.'); return; }
  const payload = buildPix({
    key: 'azuosraul999@gmail.com', // TODO: sua CHAVE PIX real
    name:'NOHEROES R',             // máx 25 chars
    city:'SAO PAULO',              // sem acento
    txid:(pendingDonation.destino==='servidor'?'SERVIDOR':'GERAL')+'-'+Date.now(),
    amount: pendingDonation.valor,
    desc: pendingDonation.destino==='servidor'?'Servidor':'NoHeroes'
  });
  // Preenche e cria QR
  const codeEl = document.getElementById('pixCode');
  codeEl.value = payload;
  const container = document.getElementById('pixQr');
  container.innerHTML = '';
  if (window.QRCode) {
    QRCode.toCanvas(payload,{errorCorrectionLevel:'M', width:220},(err,canvas)=>{
      if(err){ console.error(err); alert('Falha ao gerar QR PIX'); return; }
      container.appendChild(canvas);
    });
  } else {
    container.innerHTML = '<div class="text-sm text-white/60">Falha ao carregar gerador de QR. Copie o código abaixo.</div>';
  }
  pixModal.classList.add('show');
});

document.getElementById('copyPix').addEventListener('click', ()=>{
  const el = document.getElementById('pixCode');
  el.select(); el.setSelectionRange(0,99999);
  document.execCommand('copy');
  alert('Código PIX copiado.');
});

/* ===== Mercado Pago ===== */
document.getElementById('payMP').addEventListener('click', ()=>{
  if(!pendingDonation.valor){ alert('Informe um valor.'); return; }
  // Dica: gere um preference_id por valor/destino no backend e injete o link aqui:
  // document.getElementById('mpLink').href = 'URL_DA_SUA_PREFERENCE';
  document.getElementById('modalMP').classList.add('show');
});

/* ===== PayPal (Smart Buttons) ===== */
document.getElementById('payPayPal').addEventListener('click', ()=>{
  if(!pendingDonation.valor){ alert('Informe um valor.'); return; }
  document.getElementById('modalPayPal').classList.add('show');
  const host = document.getElementById('paypalButtons');
  host.innerHTML = '';
  paypal.Buttons({
    style: { layout:'vertical', shape:'pill', label:'paypal' },
    createOrder: (data, actions) => actions.order.create({
      purchase_units: [{
        amount: { currency_code: 'BRL', value: pendingDonation.valor.toFixed(2) },
        description: pendingDonation.destino==='servidor' ? 'Doação — Servidor do Universo' : 'Doação — Meta Geral NoHeroes'
      }]
    }),
    onApprove: async (data, actions) => {
      try{
        await actions.order.capture();
        alert('Pagamento aprovado pelo PayPal. Obrigado pelo apoio!');
        document.getElementById('modalPayPal').classList.remove('show');
        // TODO (produção): validar server-side via webhook e atualizar metas
      }catch(e){ console.error(e); alert('Falha ao capturar pagamento.'); }
    },
    onError: (err) => { console.error(err); alert('Erro no PayPal. Tente novamente.'); }
  }).render('#paypalButtons');
});

/* ===== Leads ===== */
const state = JSON.parse(localStorage.getItem('nh_leads')||'{"leads":[]}');
document.getElementById('formLead').addEventListener('submit', (e)=>{
  e.preventDefault();
  const f = new FormData(e.currentTarget);
  const lead = {nome: f.get('nome'), email: f.get('email'), ts: Date.now()};
  state.leads.push(lead);
  localStorage.setItem('nh_leads', JSON.stringify(state));
  e.currentTarget.reset();
  alert('Cadastrado com sucesso!');
  // TODO (produção): POST /leads
});

/* ===== Solicitar serviço/ajuda ===== */
document.getElementById('formSolicitar').addEventListener('submit', (e)=>{
  e.preventDefault();
  const f = new FormData(e.currentTarget);
  const payload = {nome:f.get('nome'), email:f.get('email'), tipo:'solicitar', ts:Date.now()};
  // TODO (produção): POST /requests
  e.currentTarget.reset();
  document.getElementById('modalSolicitar').classList.remove('show');
  alert('Recebido! Em breve entraremos em contato.');
});

/* ===== Util ===== */
document.getElementById('year').textContent = new Date().getFullYear();
</script>
</body>
</html>